name: CI Pipeline

# üöÄ –≠—Ç–æ—Ç workflow –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º push –∏–ª–∏ pull request
# –û–Ω –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞, –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ç–µ—Å—Ç—ã –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]

jobs:
  # üìù –≠–¢–ê–ü 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∏–ª—è –∫–æ–¥–∞ –∏ –∏–º–ø–æ—Ä—Ç–æ–≤
  # –ó–¥–µ—Å—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Å–æ–±–ª—é–¥–µ–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è Python –∫–æ–¥–∞
  lint:
    name: "üìù Code Linting (Style Check)"
    runs-on: ubuntu-latest
    steps:
    - name: "üì• –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–¥–∞ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è"
      uses: actions/checkout@v4
    
    - name: "üêç –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python"
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'
    
    - name: "üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π"
      run: |
        echo "üîß –û–±–Ω–æ–≤–ª—è–µ–º pip –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–¥–∞..."
        python -m pip install --upgrade pip
        pip install -r requirements.txt
        echo "‚úÖ –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã!"
    
    - name: "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∏–ª—è –∫–æ–¥–∞ —Å –ø–æ–º–æ—â—å—é flake8"
      run: |
        echo "üîç –ó–∞–ø—É—Å–∫ flake8 - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–æ–±–ª—é–¥–µ–Ω–∏–µ PEP8 —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞..."
        echo "–ü—Ä–æ–≤–µ—Ä—è–µ–º: –æ—Ç—Å—Ç—É–ø—ã, –¥–ª–∏–Ω—É —Å—Ç—Ä–æ–∫, –∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏"
        flake8 calculator.py test_calculator.py
        echo "‚úÖ flake8 –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ! –ö–æ–¥ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º."
    
    - name: "üì¶ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏–º–ø–æ—Ä—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é isort"
      run: |
        echo "üì¶ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏–º–ø–æ—Ä—Ç–æ–≤..."
        echo "isort –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ import'–æ–≤ –≤ –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–æ–≤"
        isort --check-only calculator.py test_calculator.py
        echo "‚úÖ isort –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ! –ò–º–ø–æ—Ä—Ç—ã –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ."

  # üé® –≠–¢–ê–ü 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞
  # Black –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
  format:
    name: "üé® Code Formatting (Black)"
    runs-on: ubuntu-latest
    steps:
    - name: "üì• –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–¥–∞ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è"
      uses: actions/checkout@v4
    
    - name: "üêç –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python"
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'
    
    - name: "üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π"
      run: |
        echo "üîß –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Black formatter..."
        python -m pip install --upgrade pip
        pip install -r requirements.txt
        echo "‚úÖ Black —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!"
    
    - name: "üé® –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞ —Å –ø–æ–º–æ—â—å—é Black"
      run: |
        echo "üé® Black –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞..."
        echo "–ü—Ä–æ–≤–µ—Ä—è–µ–º: –æ—Ç—Å—Ç—É–ø—ã, –∫–∞–≤—ã—á–∫–∏, –ø—Ä–æ–±–µ–ª—ã, –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫"
        black --check calculator.py test_calculator.py
        echo "‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º Black!"

  # üî¨ –≠–¢–ê–ü 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
  # MyPy –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–∏–ø–æ–≤
  type-check:
    name: "üî¨ Type Checking (MyPy)"
    runs-on: ubuntu-latest
    steps:
    - name: "üì• –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–¥–∞ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è"
      uses: actions/checkout@v4
    
    - name: "üêç –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python"
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'
    
    - name: "üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π"
      run: |
        echo "üîß –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º MyPy type checker..."
        python -m pip install --upgrade pip
        pip install -r requirements.txt
        echo "‚úÖ MyPy —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!"
    
    - name: "üî¨ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é MyPy"
      run: |
        echo "üî¨ MyPy –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö..."
        echo "–≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å –æ—à–∏–±–∫–∏ –¥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã"
        mypy calculator.py || echo "‚ö†Ô∏è –ù–∞–π–¥–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å —Ç–∏–ø–∞–º–∏ (—ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –¥–µ–º–æ –ø—Ä–æ–µ–∫—Ç–∞)"
        echo "‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"

  # üîí –≠–¢–ê–ü 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∫–æ–¥–∞
  # Bandit –∏—â–µ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ –∫–æ–¥–µ
  security:
    name: "üîí Security Check (Bandit)"
    runs-on: ubuntu-latest
    steps:
    - name: "üì• –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–¥–∞ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è"
      uses: actions/checkout@v4
    
    - name: "üêç –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python"
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'
    
    - name: "üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π"
      run: |
        echo "üîß –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Bandit security linter..."
        python -m pip install --upgrade pip
        pip install -r requirements.txt
        echo "‚úÖ Bandit —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!"
    
    - name: "üîí –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∫–æ–¥–∞ —Å –ø–æ–º–æ—â—å—é Bandit"
      run: |
        echo "üîí Bandit –∏—â–µ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏..."
        echo "–ü—Ä–æ–≤–µ—Ä—è–µ–º: –æ–ø–∞—Å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, SQL –∏–Ω—ä–µ–∫—Ü–∏–∏, –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã"
        bandit -r calculator.py || echo "‚ö†Ô∏è –ù–∞–π–¥–µ–Ω—ã –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"
        echo "‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"

  # üß™ –≠–¢–ê–ü 5: –ó–∞–ø—É—Å–∫ unit —Ç–µ—Å—Ç–æ–≤
  # –°–∞–º—ã–π –≤–∞–∂–Ω—ã–π —ç—Ç–∞–ø - –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
  test:
    name: "üß™ Unit Tests & Coverage"
    runs-on: ubuntu-latest
    steps:
    - name: "üì• –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–¥–∞ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è"
      uses: actions/checkout@v4
    
    - name: "üêç –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python"
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'
    
    - name: "üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π"
      run: |
        echo "üîß –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º pytest –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è..."
        python -m pip install --upgrade pip
        pip install -r requirements.txt
        echo "‚úÖ –í—Å–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã!"
    
    - name: "üß™ –ó–∞–ø—É—Å–∫ unit —Ç–µ—Å—Ç–æ–≤ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞"
      run: |
        echo "üß™ –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö unit —Ç–µ—Å—Ç–æ–≤..."
        echo "Pytest –ø—Ä–æ–≤–µ—Ä–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞"
        echo "Coverage –ø–æ–∫–∞–∂–µ—Ç –∫–∞–∫–∞—è —á–∞—Å—Ç—å –∫–æ–¥–∞ –ø–æ–∫—Ä—ã—Ç–∞ —Ç–µ—Å—Ç–∞–º–∏"
        pytest -v --cov=calculator --cov-report=term-missing
        echo "‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ!"
    
    - name: "üîß –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞"
      run: |
        echo "üîß –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–±–æ—Ç—É –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É..."
        echo "–≠—Ç–æ –∏–º–∏—Ç–∏—Ä—É–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º"
        python calculator.py add 2 3
        python calculator.py mul 4 5
        python calculator.py div 10 2
        echo "‚úÖ CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!"

  # üöÄ –≠–¢–ê–ü 6: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
  # –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ
  integration:
    name: "üöÄ Integration Tests"
    runs-on: ubuntu-latest
    needs: [lint, format, test]  # –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
    steps:
    - name: "üì• –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–¥–∞ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è"
      uses: actions/checkout@v4
    
    - name: "üêç –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python"
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'
    
    - name: "üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π"
      run: |
        echo "üîß –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –æ–∫—Ä—É–∂–µ–Ω–∏–µ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤..."
        python -m pip install --upgrade pip
        pip install -r requirements.txt
        echo "‚úÖ –û–∫—Ä—É–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ!"
    
    - name: "üöÄ –ó–∞–ø—É—Å–∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤"
      run: |
        echo "üöÄ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç —Ä–∞–±–æ—Ç—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Ü–µ–ª–∏–∫–æ–º..."
        echo "–≠—Ç–æ —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º"
        
        echo "–¢–µ—Å—Ç 1: –°–ª–æ–∂–µ–Ω–∏–µ –±–æ–ª—å—à–∏—Ö —á–∏—Å–µ–ª"
        result=$(python calculator.py add 10 20)
        echo "–†–µ–∑—É–ª—å—Ç–∞—Ç: $result"
        
        echo "–¢–µ—Å—Ç 2: –°–ª–æ–∂–Ω–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞"
        result=$(python calculator.py div 15 3)
        echo "–†–µ–∑—É–ª—å—Ç–∞—Ç: $result"
        
        echo "–¢–µ—Å—Ç 3: –í–æ–∑–≤–µ–¥–µ–Ω–∏–µ –≤ —Å—Ç–µ–ø–µ–Ω—å"
        result=$(python calculator.py pow 2 8)
        echo "–†–µ–∑—É–ª—å—Ç–∞—Ç: $result"
        
        echo "‚úÖ –í—Å–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ! –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!" 